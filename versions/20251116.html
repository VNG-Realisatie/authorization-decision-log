<!DOCTYPE html><html lang="en"><head>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<meta name="generator" content="ReSpec 35.4.1">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-color:var(--warning-border,#f11);border-width:.2em;border-style:solid;background:#fbe9e9;background:var(--warning-bg,#fbe9e9);color:#000;color:var(--text,#000)}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
  
  
  
  
  
  
  
<script>document.title = respecConfig.title</script>
<title>Authorization Decision Log</title>
  
<title>Default</title>

  
  
<style type="text/css">

    .figure pre, .sidefigure pre, figure pre {
      width: 100%;
    }
  
</style>

<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:italic}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline;position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-.7em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<style id="respec-nlgov">
img.license{float:left;padding-right:5px;background:0 0}
</style>
<meta name="color-scheme" content="light">
<style>
ul.index{columns:30ch;column-gap:1.5em}
ul.index li{list-style:inherit}
ul.index li span{color:inherit;cursor:pointer;white-space:normal}
#index-defined-here ul.index li{font-size:.9rem}
ul.index code{color:inherit}
#index-defined-here .print-only{display:none}
@media print{
#index-defined-here .print-only{display:initial}
}
</style>
<meta name="description" content="This document defines a standardized method for logging decisions to allow or deny API requests to enable reconstruction and analysis of historical decisions.">
<style>
.hljs{--base:#fafafa;--mono-1:#383a42;--mono-2:#686b77;--mono-3:#717277;--hue-1:#0b76c5;--hue-2:#336ae3;--hue-3:#a626a4;--hue-4:#42803c;--hue-5:#ca4706;--hue-5-2:#c91243;--hue-6:#986801;--hue-6-2:#9a6a01}
@media (prefers-color-scheme:dark){
.hljs{--base:#282c34;--mono-1:#abb2bf;--mono-2:#818896;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61aeee;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e6c07b}
}
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;color:var(--mono-1,#383a42);background:#fafafa;background:var(--base,#fafafa)}
.hljs-comment,.hljs-quote{color:#717277;color:var(--mono-3,#717277);font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4;color:var(--hue-3,#a626a4)}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;color:var(--hue-5,#ca4706);font-weight:700}
.hljs-literal{color:#0b76c5;color:var(--hue-1,#0b76c5)}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c;color:var(--hue-4,#42803c)}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01;color:var(--hue-6-2,#9a6a01)}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801;color:var(--hue-6,#986801)}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3;color:var(--hue-2,#336ae3)}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>

  .sidelabel {
    position: fixed;
    -webkit-transform-origin: top right;
    right: 100%;
    top: 0;
    -webkit-transform: rotate(-90deg);
    padding: 4px 50px 4px 10px;
    color: white;
    white-space: nowrap;
    z-index: 1;
    background-color: #39870c;
  }
</style>
<script type="text/javascript">
   /* Any custom mermaid.js scripts will go here. */
  </script>
<style>

  /* Any custom mermaid.js scripts will go here. */
  }
</style>
<script id="initialUserConfig" type="application/json">{
  "nl_organisationName": "Logius",
  "nl_organisationStylesURL": "https://gitdocumentatie.logius.nl/publicatie/respec/style/",
  "nl_organisationPublishURL": "https://gitdocumentatie.logius.nl/publicatie/",
  "logos": [
    {
      "src": "https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/figure-logius.svg",
      "alt": "Logius",
      "id": "Logius",
      "height": 77,
      "width": 44,
      "url": "https://www.logius.nl/standaarden"
    }
  ],
  "postProcess": [
    null
  ],
  "latestVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName"
  ],
  "thisVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "specStatus",
    "-",
    "specType",
    "-",
    "shortName",
    "-",
    "publishDate"
  ],
  "prevVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "previousMaturity",
    "-",
    "specType",
    "-",
    "shortName",
    "-",
    "previousPublishDate"
  ],
  "useLogo": true,
  "useLabel": true,
  "license": "cc-by",
  "addSectionLinks": true,
  "maxTocLevel": 4,
  "localizationStrings": {
    "en": {
      "wv": "Draft",
      "cv": "Recommendation",
      "vv": "Proposed recommendation",
      "def": "Definitive version",
      "basis": "Document",
      "eo": "Outdated version",
      "tg": "Rescinded version",
      "no": "Norm",
      "st": "Standard",
      "im": "Information model",
      "pr": "Guideline",
      "hr": "Guide",
      "wa": "Proposed recommendation",
      "al": "General",
      "bd": "Governance documentation",
      "bp": "Best practice"
    },
    "nl": {
      "wv": "Werkversie",
      "cv": "Consultatieversie",
      "vv": "Versie ter vaststelling",
      "def": "Vastgestelde versie",
      "basis": "Document",
      "eo": "Verouderde versie",
      "tg": "Teruggetrokken versie",
      "no": "Norm",
      "st": "Standaard",
      "im": "Informatiemodel",
      "pr": "Praktijkrichtlijn",
      "hr": "Handreiking",
      "wa": "Werkafspraak",
      "al": "Algemeen",
      "bd": "Beheerdocumentatie",
      "bp": "Best practice"
    }
  },
  "sotdText": {
    "nl": {
      "sotd": "Status van dit document",
      "def": "Dit is de definitieve versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "wv": "Dit is een werkversie die op elk moment kan worden gewijzigd, verwijderd of vervangen door andere documenten. Het is geen door het TO goedgekeurde consultatieversie.",
      "cv": "Dit is een door het TO goedgekeurde consultatieversie. Commentaar over dit document kan gestuurd worden naar ",
      "vv": "Dit is een definitief concept van de nieuwe versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "basis": "Dit is een document zonder officiële status."
    },
    "en": {
      "sotd": "Status of This Document",
      "def": "This is the definitive version of this document. Edits resulting from consultations have been applied.",
      "wv": "This is a draft that could be altered, removed or replaced by other documents. It is not a recommendation approved by TO.",
      "cv": "This is a proposed recommendation approved by TO. Comments regarding this document may be sent to ",
      "vv": "This is the definitive concept of this document. Edits resulting from consultations have been applied.",
      "basis": "This document has no official standing."
    }
  },
  "labelColor": {
    "def": "#154273",
    "wv": "#39870c"
  },
  "licenses": {
    "cc0": {
      "name": "Creative Commons 0 Public Domain Dedication",
      "short": "CC0",
      "url": "https://creativecommons.org/publicdomain/zero/1.0/",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-zero.svg"
    },
    "cc-by": {
      "name": "Creative Commons Attribution 4.0 International Public License",
      "short": "CC-BY",
      "url": "https://creativecommons.org/licenses/by/4.0/legalcode",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by.svg"
    },
    "cc-by-nd": {
      "name": "Creative Commons Naamsvermelding-GeenAfgeleideWerken 4.0 Internationaal",
      "short": "CC-BY-ND",
      "url": "https://creativecommons.org/licenses/by-nd/4.0/legalcode.nl",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by-nd.svg"
    }
  },
  "localBiblio": {
    "AuthZen": {
      "href": "https://openid.net/specs/authorization-api-1_0-03.html",
      "title": "Authorization API 1.0 – draft 03",
      "authors": [
        "O. Gazitt",
        "D. Brossard",
        "A. Tulshibagwale"
      ],
      "id": "authzen"
    },
    "REST API Design Rules": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/adr/",
      "title": "NLGov REST API Design Rules 2.0.0",
      "authors": [
        "Jasper Roes",
        "Joost Farla"
      ],
      "date": "Maart 2024",
      "id": "rest api design rules"
    },
    "Logboek dataverwerkingen": {
      "href": "https://logius-standaarden.github.io/logboek-dataverwerkingen/",
      "title": "Logboek dataverwerkingen",
      "authors": [
        "Eelco Hotting",
        "Vedran Bilanovic"
      ],
      "date": "n.t.b.",
      "id": "logboek dataverwerkingen"
    },
    "FSC - Core": {
      "href": "https://commonground.gitlab.io/standards/fsc/core/draft-fsc-core-00.html",
      "title": "FSC - Core",
      "authors": [
        "Eelco Hotting",
        "Ronald Koster",
        "Henk van Maanen",
        "Niels Dequeker",
        "Edward van Gelderen",
        "Pim Gaemers"
      ],
      "date": "8 december 2023",
      "id": "fsc - core"
    },
    "FSC - Logging": {
      "href": "https://commonground.gitlab.io/standards/fsc/logging/draft-fsc-logging-00.html",
      "title": "FSC - Logging",
      "authors": [
        "Eelco Hotting",
        "Ronald Koster",
        "Henk van Maanen",
        "Niels Dequeker",
        "Edward van Gelderen",
        "Pim Gaemers"
      ],
      "date": "8 december 2023",
      "id": "fsc - logging"
    },
    "NIST.SP.800-162": {
      "href": "https://www.nist.gov/publications/guide-attribute-based-access-control-abac-definition-and-considerations-1",
      "title": "Guide to Attribute Based Access Control (ABAC) Definition and Considerations",
      "authors": [
        "Chung Tong Hu",
        "David F. Ferraiolo",
        "David R. Kuhn"
      ],
      "date": "February 25, 2019",
      "id": "nist.sp.800-162"
    },
    "ISO/IEC 27001:2022": {
      "href": "https://www.iso.org/standard/27001.html",
      "title": "Information security, cybersecurity and privacy protection — Information security management systems — Requirements",
      "date": "2022-10",
      "id": "iso/iec 27001:2022"
    },
    "ISO/IEC 27002:2022": {
      "href": "https://www.iso.org/standard/75652.html",
      "title": "Information security, cybersecurity and privacy protection — Information security controls",
      "date": "2022-02",
      "id": "iso/iec 27002:2022"
    },
    "BIO2": {
      "href": "https://www.bio-overheid.nl/media/cs5ctudu/20250924-baseline-informatiebeveiliging-overheid-2-bio2-v12-def.pdf?csf=1&web=1&e=9JoWOT",
      "title": "Baseline Informatiebeveiliging Overheid 2",
      "date": "24 september 2025",
      "id": "bio2"
    }
  },
  "specStatus": "WV",
  "specType": "ST",
  "pubDomain": "dk",
  "shortName": "authorization-decision-log",
  "publishDate": "2024-05-19",
  "publishVersion": "0.0.1",
  "previousPublishVersion": null,
  "previousPublishDate": null,
  "previousMaturity": "WV",
  "title": "Authorization Decision Log",
  "content": {
    "introduction": "introduction",
    "architecture": "architecture",
    "specifications": "specifications",
    "levels-of-detail": "levels-of-detail",
    "information-management": "information-management"
  },
  "editors": [],
  "authors": [
    {
      "name": "Maikel Hofman",
      "company": "VNG Realisatie"
    },
    {
      "name": "Guus van der Meer",
      "company": "Vecozo"
    },
    {
      "name": "Michiel Trimpe",
      "company": "VNG Realisatie"
    }
  ],
  "alternateFormats": []
}</script>
<link rel="stylesheet" href="https://gitdocumentatie.logius.nl/publicatie/respec/style/base.css"></head>

<body class="h-entry"><div class="head">
    <a class="logo" href="https://www.logius.nl/standaarden"><img alt="Logius" height="77" id="Logius" src="https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/figure-logius.svg" width="44">
  </a> <h1 id="title" class="title">Authorization Decision Log</h1>
    
    <h2>
      Logius Standard<br>
      Draft
      <time class="dt-published" datetime="2024-05-19">August 25, 2025</time>
    </h2>
    <dl>
      
      <dt>Latest published version:</dt><dd>
              <a href="https://gitdocumentatie.logius.nl/publicatie/dk/authorization-decision-log">https://gitdocumentatie.logius.nl/publicatie/dk/authorization-decision-log</a>
            </dd>
      
      
      
      
      <dt>Previous version:</dt><dd><a href="https://gitdocumentatie.logius.nl/publicatie/dk/wv-st-authorization-decision-log-19700101">https://gitdocumentatie.logius.nl/publicatie/dk/wv-st-authorization-decision-log-19700101</a></dd>
      
      <dt>Editor:</dt>
      
      
      <dt>Authors:</dt><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Maikel Hofman</span> (<span class="p-org org h-org">VNG Realisatie</span>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Guus van der Meer</span> (<span class="p-org org h-org">Vecozo</span>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Michiel Trimpe</span> (<span class="p-org org h-org">VNG Realisatie</span>)
  </dd>
      
    </dl>
    
    
    <p>
          This document is also available in these non-normative format:
          
        </p>
    <p class="copyright">
            This document is licensed under 
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/legalcode" class="subfoot"><img class="license" src="https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by.svg" alt="Logo Creative Commons Attribution 4.0 International Public License"><br> Creative Commons Attribution 4.0 International Public License</a>
          </p>
    <hr title="Separator for header">
  </div>
  <section id="abstract" class="introductory"><h2>Abstract</h2><p>This document defines a standardized method for logging decisions to allow or deny API requests to enable reconstruction and analysis of historical decisions.</p>
</section>
  <section id="sotd" class="introductory"><h2>Status of This Document</h2><p>This is a draft that could be altered, removed or replaced by other documents. It is not a recommendation approved by TO.</p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#purpose-of-this-standard"><bdi class="secno">1.1 </bdi>Purpose of this standard</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#applicability"><bdi class="secno">1.1.1 </bdi>Applicability</a></li><li class="tocline"><a class="tocxref" href="#target-audience"><bdi class="secno">1.1.2 </bdi>Target Audience</a></li></ol></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">1.2 </bdi>Terminology</a></li></ol></li><li class="tocline"><a class="tocxref" href="#architecture"><bdi class="secno">2. </bdi>Architecture</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#context"><bdi class="secno">2.1 </bdi>Context</a></li><li class="tocline"><a class="tocxref" href="#components"><bdi class="secno">2.2 </bdi>Components</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#authorization-decision-log"><bdi class="secno">2.2.1 </bdi>Authorization Decision Log</a></li><li class="tocline"><a class="tocxref" href="#policy-enforcement-point-pep"><bdi class="secno">2.2.2 </bdi>Policy Enforcement Point (PEP)</a></li><li class="tocline"><a class="tocxref" href="#policy-administration-point-pap"><bdi class="secno">2.2.3 </bdi>Policy Administration Point (PAP)</a></li><li class="tocline"><a class="tocxref" href="#policy-information-point-pip"><bdi class="secno">2.2.4 </bdi>Policy Information Point (PIP)</a></li><li class="tocline"><a class="tocxref" href="#policy-decision-point-pdp"><bdi class="secno">2.2.5 </bdi>Policy Decision Point (PDP)</a></li></ol></li><li class="tocline"><a class="tocxref" href="#scope"><bdi class="secno">2.3 </bdi>Scope</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#no-specification-for-the-management-of-logs"><bdi class="secno">2.3.1 </bdi>No specification for the management of logs</a></li></ol></li><li class="tocline"><a class="tocxref" href="#flows"><bdi class="secno">2.4 </bdi>Flows</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#writing-a-log-record-after-an-authorization-decision"><bdi class="secno">2.4.1 </bdi>Writing a log record after an authorization decision</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#specifications"><bdi class="secno">3. </bdi>Specifications</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#protocols"><bdi class="secno">3.1 </bdi>Protocols</a></li><li class="tocline"><a class="tocxref" href="#behavior"><bdi class="secno">3.2 </bdi>Behavior</a></li><li class="tocline"><a class="tocxref" href="#interface"><bdi class="secno">3.3 </bdi>Interface</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#identifiers"><bdi class="secno">3.3.1 </bdi>Identifiers</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#spec-trace-context"><bdi class="secno">3.3.1.1 </bdi>W3C Trace Context</a></li><li class="tocline"><a class="tocxref" href="#spec-fsc-transaction-id"><bdi class="secno">3.3.1.2 </bdi>FSC Transaction ID</a></li><li class="tocline"><a class="tocxref" href="#spec-generic-id"><bdi class="secno">3.3.1.3 </bdi>Generic identifier</a></li></ol></li><li class="tocline"><a class="tocxref" href="#request-and-response"><bdi class="secno">3.3.2 </bdi>Request and response</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#spec-timestamp"><bdi class="secno">3.3.2.1 </bdi>Timestamp</a></li><li class="tocline"><a class="tocxref" href="#spec-type"><bdi class="secno">3.3.2.2 </bdi>Type</a></li><li class="tocline"><a class="tocxref" href="#spec-request"><bdi class="secno">3.3.2.3 </bdi>Request</a></li><li class="tocline"><a class="tocxref" href="#spec-response"><bdi class="secno">3.3.2.4 </bdi>Response</a></li><li class="tocline"><a class="tocxref" href="#examples-non-normative"><bdi class="secno">3.3.2.5 </bdi>Examples (non-normative)</a></li></ol></li><li class="tocline"><a class="tocxref" href="#spec-policies"><bdi class="secno">3.3.3 </bdi>Policy Sources</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#examples-non-normative-0"><bdi class="secno">3.3.3.1 </bdi>Examples (non-normative)</a></li></ol></li><li class="tocline"><a class="tocxref" href="#spec-information"><bdi class="secno">3.3.4 </bdi>Information Sources</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#examples-non-normative-1"><bdi class="secno">3.3.4.1 </bdi>Examples (non-normative)</a></li></ol></li><li class="tocline"><a class="tocxref" href="#spec-configuration"><bdi class="secno">3.3.5 </bdi>Configuration Sources</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#examples-non-normative-2"><bdi class="secno">3.3.5.1 </bdi>Examples (non-normative)</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#source-references"><bdi class="secno">3.4 </bdi>Sources and referencing</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#versioned-sources"><bdi class="secno">3.4.1 </bdi>Versioned sources</a></li><li class="tocline"><a class="tocxref" href="#temporal-sources"><bdi class="secno">3.4.2 </bdi>Temporal sources</a></li><li class="tocline"><a class="tocxref" href="#logged-sources"><bdi class="secno">3.4.3 </bdi>Logged sources</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#data-verifiability-and-level-of-detail"><bdi class="secno">4. </bdi>Data Verifiability and Level of Detail</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#definition-of-levels"><bdi class="secno">4.1 </bdi>Definition of Levels</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#level-1-decision-request-response"><bdi class="secno">4.1.1 </bdi>Level 1: Decision Request/Response</a></li><li class="tocline"><a class="tocxref" href="#level-2-decision-and-policies"><bdi class="secno">4.1.2 </bdi>Level 2: Decision and Policies</a></li><li class="tocline"><a class="tocxref" href="#level-3-all-information-sources"><bdi class="secno">4.1.3 </bdi>Level 3: All Information Sources</a></li><li class="tocline"><a class="tocxref" href="#level-4-full-environment"><bdi class="secno">4.1.4 </bdi>Level 4: Full Environment</a></li></ol></li><li class="tocline"><a class="tocxref" href="#implications-of-levels"><bdi class="secno">4.2 </bdi>Implications of levels</a></li></ol></li><li class="tocline"><a class="tocxref" href="#information-management"><bdi class="secno">5. </bdi>Information Management and Compliance</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#legal-and-privacy-compliance"><bdi class="secno">5.1 </bdi>Legal and Privacy Compliance</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#purpose-limitation"><bdi class="secno">5.1.1 </bdi>Purpose Limitation</a></li><li class="tocline"><a class="tocxref" href="#data-minimization"><bdi class="secno">5.1.2 </bdi>Data Minimization</a></li><li class="tocline"><a class="tocxref" href="#data-retention"><bdi class="secno">5.1.3 </bdi>Data Retention</a></li><li class="tocline"><a class="tocxref" href="#transparency-and-subject-rights"><bdi class="secno">5.1.4 </bdi>Transparency and Subject Rights</a></li></ol></li><li class="tocline"><a class="tocxref" href="#access-control"><bdi class="secno">5.2 </bdi>Access Control</a></li><li class="tocline"><a class="tocxref" href="#security-and-integrity"><bdi class="secno">5.3 </bdi>Security and Integrity</a></li></ol></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">6. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#tof"><bdi class="secno">7. </bdi>List of Figures</a></li><li class="tocline"><a class="tocxref" href="#index"><bdi class="secno">A. </bdi>Index</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#index-defined-here"><bdi class="secno">A.1 </bdi>Terms defined by this specification</a></li><li class="tocline"><a class="tocxref" href="#index-defined-elsewhere"><bdi class="secno">A.2 </bdi>Terms defined by reference</a></li></ol></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">B. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">B.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">B.2 </bdi>Informative references</a></li></ol></li></ol></nav><section class="introduction" id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div>
<p>The Authorization Decision Log standard defines a standard method for logging authorization decisions. The standard builds on the information models defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-authzen" title="Authorization API 1.0 – draft 03">AuthZen</a></cite>] to log decisions. </p>
<p>It augments this with a structure for recording environmental factors that affected the evaluation decision. These are separated into active policies, additional information sources and configuration of the evaluation engine as per the architectural components introduced by [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist.sp.800-162" title="Guide to Attribute Based Access Control (ABAC) Definition and Considerations">NIST.SP.800-162</a></cite>], also known as the "PxP" architecture.</p>
<p>Additionally, it includes a non-normative outline introducing the concerns, principles and requirements for developing and maintaining such a log in concordance with legislation.</p>
<section id="purpose-of-this-standard"><div class="header-wrapper"><h3 id="x1-1-purpose-of-this-standard"><bdi class="secno">1.1 </bdi>Purpose of this standard</h3><a class="self-link" href="#purpose-of-this-standard" aria-label="Permalink for Section 1.1"></a></div>
<p>This standard defines a uniform approach for logging authorization decisions, enabling organizations to provide effective accountability for historical decisions. </p>
<p>The standard provides a structured format for all contextual and environmental parameters that affect decisions. A full implementation of the standard allows historical decisions to be replayed for analysis.</p>
<section id="applicability"><div class="header-wrapper"><h4 id="x1-1-1-applicability"><bdi class="secno">1.1.1 </bdi>Applicability</h4><a class="self-link" href="#applicability" aria-label="Permalink for Section 1.1.1"></a></div>
<p>Functionally, the standard is applicable to any API request. Organizationally, it applies to Dutch governmental bodies — such as the central government, provinces, municipalities, and water boards — as well as institutions in the public or semi-public sector.</p>
</section><section id="target-audience"><div class="header-wrapper"><h4 id="x1-1-2-target-audience"><bdi class="secno">1.1.2 </bdi>Target Audience</h4><a class="self-link" href="#target-audience" aria-label="Permalink for Section 1.1.2"></a></div>
<p>The target audience for the standard includes organizations involved in making and accounting for access decisions, both within their own organization and in collaborations with other parties. This may include the Dutch government and other relevant authorities.</p>
</section></section><section id="terminology"><div class="header-wrapper"><h3 id="x1-2-terminology"><bdi class="secno">1.2 </bdi>Terminology</h3><a class="self-link" href="#terminology" aria-label="Permalink for Section 1.2"></a></div>
<p>The following list defines terminology used throughout this document.</p>
<p><strong>Authorization</strong></p>
<p>Authorization is the process of deciding whether to, fully or partially, allow or deny requests for processing (API requests) and enforcing these decisions.</p>
<p><strong>Externalized Authorization Management</strong></p>
<p>Externalized Authorization Management (EAM) is an architectural pattern in which authorization decisions are made outside of the applications that enforce the decision. </p>
<p><strong>Log</strong></p>
<p>A structured record of events, called log records, generated by a service. Logs are intended for operational monitoring, auditing, and troubleshooting.</p>
<p><strong>Log record</strong></p>
<p>A single unit of information within a log, representing one recorded event. Each log record is immutable once written and collectively forms the log.</p>
<p><strong>Policies</strong></p>
<p>A set of one or more rules that determine whether a request should be allowed or denied.</p>
<p><strong>Source</strong></p>
<p>A source of one or more pieces of information, such as attributes or policies, which affected an authorization decision and which come from a single source.</p>
<p>When a source is later queried for historical information, a single identifier, such as a version, hash, or timestamp, should be sufficient to retrieve all historical information from that source.</p>
<p><strong>Replay</strong></p>
<p>The recreation of the environment in which an authorization decision took place, allowing for analysis of historical decisions.</p>
</section></section><section class="architecture" id="architecture"><div class="header-wrapper"><h2 id="x2-architecture"><bdi class="secno">2. </bdi>Architecture</h2><a class="self-link" href="#architecture" aria-label="Permalink for Section 2."></a></div>
<p>This section describes the common EAM architecture within which the authorization decisions are logged.</p>
<section id="context"><div class="header-wrapper"><h3 id="x2-1-context"><bdi class="secno">2.1 </bdi>Context</h3><a class="self-link" href="#context" aria-label="Permalink for Section 2.1"></a></div>
<p>The Authorization Decision Log defines a standard format for recording decisions made by Externalized Authorization Management (EAM) systems.</p>
<p>The goal of the standard is to enable the recreation of the environment in which historical authorization decisions were made to enable analysis of decisions while preventing unnecessary data duplication.</p>
<p>The inputs for records in the Authorization Decision Log come from the following standard EAM or PxP components as introduced in [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist.sp.800-162" title="Guide to Attribute Based Access Control (ABAC) Definition and Considerations">NIST.SP.800-162</a></cite>] and adopt the information model introduced in [<cite><a class="bibref" data-link-type="biblio" href="#bib-authzen" title="Authorization API 1.0 – draft 03">AuthZEN</a></cite>].</p>
<figure id="fig-eam-or-pxp-architecture">

<p><img src="./images/eam-architecture.svg" alt="diagram"></p>
<figcaption><a class="self-link" href="#fig-eam-or-pxp-architecture">Figure <bdi class="figno">1</bdi></a> <span class="fig-title">EAM or PxP Architecture</span></figcaption>
</figure>


<p>In a federated context, such as introduced by [<cite><a class="bibref" data-link-type="biblio" href="#bib-fsc - core" title="FSC - Core">FSC - Core</a></cite>], both the consumer outway and provider inway function as a PEP for incoming and outgoing requests. Both the consumer and the provider ask an internal PDP to decide on allowing the request. Both of these decisions can be logged using this standard.</p>
<p>When combined with tracing headers such as [<cite><a class="bibref" data-link-type="biblio" href="#bib-trace-context" title="Trace Context">trace-context</a></cite>] introduced by [<cite><a class="bibref" data-link-type="biblio" href="#bib-logboek dataverwerkingen" title="Logboek dataverwerkingen">Logboek dataverwerkingen</a></cite>] and the FSC Transaction ID used in [<cite><a class="bibref" data-link-type="biblio" href="#bib-fsc - logging" title="FSC - Logging">FSC - Logging</a></cite>], this enables full traceability across complex multi-organizational processing chains.</p>
<p>See the sequence diagram below for an example of such a flow.</p>
<figure id="fig-decision-logging-in-federated-context">

<p><img src="./images/federated-logging.svg" alt="diagram"></p>
<figcaption><a class="self-link" href="#fig-decision-logging-in-federated-context">Figure <bdi class="figno">2</bdi></a> <span class="fig-title">Decision logging in federated context</span></figcaption>
</figure>


</section><section id="components"><div class="header-wrapper"><h3 id="x2-2-components"><bdi class="secno">2.2 </bdi>Components</h3><a class="self-link" href="#components" aria-label="Permalink for Section 2.2"></a></div>
<p>The standard EAM architecture has the following conceptual components. These can be deployed as standalone applications, combined in various configurations, or even implemented within a single monolithic application.</p>
<section id="authorization-decision-log"><div class="header-wrapper"><h4 id="x2-2-1-authorization-decision-log"><bdi class="secno">2.2.1 </bdi>Authorization Decision Log</h4><a class="self-link" href="#authorization-decision-log" aria-label="Permalink for Section 2.2.1"></a></div>
<p>The Authorization Decision Log contains all information that was used in the authorization decision. Using the Authorization Decision Log it <em><em class="rfc2119">SHOULD</em></em> be possible to accurately recreate environmental factors that affected historical authorization decisions.</p>
</section><section id="policy-enforcement-point-pep"><div class="header-wrapper"><h4 id="x2-2-2-policy-enforcement-point-pep"><bdi class="secno">2.2.2 </bdi>Policy Enforcement Point (PEP)</h4><a class="self-link" href="#policy-enforcement-point-pep" aria-label="Permalink for Section 2.2.2"></a></div>
<p>A Policy Enforcement Point (PEP) intercepts a user's request, sends it to the Policy Decision Point (PDP) for evaluation, and then enforces the resulting "permit" or "deny" decision. A PEP is typically implemented as an API gateway or as a component within the application itself.</p>
</section><section id="policy-administration-point-pap"><div class="header-wrapper"><h4 id="x2-2-3-policy-administration-point-pap"><bdi class="secno">2.2.3 </bdi>Policy Administration Point (PAP)</h4><a class="self-link" href="#policy-administration-point-pap" aria-label="Permalink for Section 2.2.3"></a></div>
<p>A Policy Administration Point (PAP) is where access policies are authored, managed, and stored. It is responsible for distributing current policies to the PDP and archiving previous versions for traceability. This can be a dedicated commercial or open-source tool or a version control system like a Git repository.</p>
</section><section id="policy-information-point-pip"><div class="header-wrapper"><h4 id="x2-2-4-policy-information-point-pip"><bdi class="secno">2.2.4 </bdi>Policy Information Point (PIP)</h4><a class="self-link" href="#policy-information-point-pip" aria-label="Permalink for Section 2.2.4"></a></div>
<p>A Policy Information Point (PIP) enriches access requests with additional attributes needed to make a decision. For example, it might retrieve a user's role or the sensitivity level of a data record from an external source. PIPs are often integrated directly into the PDP.</p>
</section><section id="policy-decision-point-pdp"><div class="header-wrapper"><h4 id="x2-2-5-policy-decision-point-pdp"><bdi class="secno">2.2.5 </bdi>Policy Decision Point (PDP)</h4><a class="self-link" href="#policy-decision-point-pdp" aria-label="Permalink for Section 2.2.5"></a></div>
<p>A Policy Decision Point (PDP) evaluates incoming requests from the PEP against the relevant policies (from the PAP) and contextual data (from the PIP) to make a "permit" or "deny" decision. The PDP is often a separate application or sidecar container.</p>
<div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="5"><span>Note</span><span class="issue-label">: EAM components within a monolithic application</span></div><p class="">
It is important to keep in mind that these are architectural components. They can also be physically implemented in a single application. In such a case the authorization interceptor can be considered the PEP; the authorization handler, the PDP; the services it invokes, the PIP; and the Git repository of the application itself, the PAP.
</p></div>

</section></section><section id="scope"><div class="header-wrapper"><h3 id="x2-3-scope"><bdi class="secno">2.3 </bdi>Scope</h3><a class="self-link" href="#scope" aria-label="Permalink for Section 2.3"></a></div>
<p>This section delineates the scope of the standard.</p>
<section id="no-specification-for-the-management-of-logs"><div class="header-wrapper"><h4 id="x2-3-1-no-specification-for-the-management-of-logs"><bdi class="secno">2.3.1 </bdi>No specification for the management of logs</h4><a class="self-link" href="#no-specification-for-the-management-of-logs" aria-label="Permalink for Section 2.3.1"></a></div>
<p>The specification defines an interface for persisting log entries. This is the component that <em><em class="rfc2119">MUST</em></em> be consistent across organizations to ensure interoperability.</p>
<p>The management of a log, however, is left to the discretion of individual implementations. Consequently, the specification does NOT define behavior or interfaces for:</p>
<ul>
<li>deleting or modifying log entries</li>
<li>managing access to the log</li>
<li>ensuring long-term accessibility</li>
<li>handling archival and retention periods</li>
<li>ensuring integrity and non-repudiation</li>
<li>maintaining time-synchronization</li>
</ul>
<p>See <a href="#information-management" data-matched-text="[[[#information-management]]]" class="sec-ref"><bdi class="secno">5. </bdi>Information Management and Compliance</a> for an overview of various aspects which <em><em class="rfc2119">MAY</em></em> be required for legal and regulatory compliance.</p>
</section></section><section id="flows"><div class="header-wrapper"><h3 id="x2-4-flows"><bdi class="secno">2.4 </bdi>Flows</h3><a class="self-link" href="#flows" aria-label="Permalink for Section 2.4"></a></div>
<section id="writing-a-log-record-after-an-authorization-decision"><div class="header-wrapper"><h4 id="x2-4-1-writing-a-log-record-after-an-authorization-decision"><bdi class="secno">2.4.1 </bdi>Writing a log record after an authorization decision</h4><a class="self-link" href="#writing-a-log-record-after-an-authorization-decision" aria-label="Permalink for Section 2.4.1"></a></div>
<figure id="fig-writing-a-log-record-after-an-authorization-decision">

<p><img src="./images/writing-log-record.svg" alt="diagram"></p>
<figcaption><a class="self-link" href="#fig-writing-a-log-record-after-an-authorization-decision">Figure <bdi class="figno">3</bdi></a> <span class="fig-title">Writing a log record after an authorization decision</span></figcaption>
</figure>

<p>To provide accountability for historical authorization decisions it must be possible to recreate the information and environment that affected the decision. The PDP provides the information required for this to the Authorization Decision Log in the form of a Log Record, as defined in the specification below. </p>
<p>The PDP <em><em class="rfc2119">SHOULD</em></em> ensure that a Log Record has been persisted to durable storage before providing the Policy Enforcement Point with the decision. The PDP then flushes this durable storage to the Authorization Decision Log, ensuring that the log record has been persisted and can be used to provide accountability when needed.</p>
</section></section></section><section class="specifications" id="specifications-0"><div class="header-wrapper"><h2 id="specifications"><bdi class="secno">3. </bdi>Specifications</h2><a class="self-link" href="#specifications" aria-label="Permalink for Section 3."></a></div><p>This section provides the specification for the protocols and interfaces to be used and the expected behavior of the components.</p>
<section id="protocols"><div class="header-wrapper"><h3 id="x3-1-protocols"><bdi class="secno">3.1 </bdi>Protocols</h3><a class="self-link" href="#protocols" aria-label="Permalink for Section 3.1"></a></div>
<p>The protocols used between the engine and the log are not prescribed in this standard.</p>
<div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="4"><span>Note</span></div><div class="">
Note, by "the protocols" we mean the method of delivering messages between components. This standard does describe the interfaces of the messages themselves. The components <i><em class="rfc2119">MUST</em></i> comply with the interfaces to ensure interoperability between component functionalities. The standard does not prescribe how that information is passed between components, as this depends on the technical/architectural choices made by software developers. This provides the freedom to add the standard to almost any software solution.
</div></div>

<p>It is <em><em class="rfc2119">RECOMMENDED</em></em> to use the OpenTelemetry Protocol (OTLP) for the interaction between the Application and the log.</p>
<div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="4"><span>Note</span></div><div class="">
OpenTelemetry is a standard and open-source framework for managing, generating, collecting, and exporting telemetry data. Using this open standard can prevent vendor-specific integrations. OpenTelemetry is a CNCF incubating project.
</div></div>


</section><section id="behavior"><div class="header-wrapper"><h3 id="x3-2-behavior"><bdi class="secno">3.2 </bdi>Behavior</h3><a class="self-link" href="#behavior" aria-label="Permalink for Section 3.2"></a></div>
<p>Each decision log entry <em><em class="rfc2119">SHOULD</em></em> be persisted to durable storage before the PDP provides a decision response to the PEP. If persistence of log entries is not confirmed, historical decisions may end up not being logged.</p>
<p>The log <em><em class="rfc2119">MUST</em></em> enforce TLS on connections, in accordance with the standard practice established within the organization.</p>
<p>See <a href="#information-management" data-matched-text="[[[#information-management]]]" class="sec-ref"><bdi class="secno">5. </bdi>Information Management and Compliance</a> for an overview of additional behavior that <em><em class="rfc2119">MAY</em></em> be required for legal and regulatory compliance.</p>
</section><section id="interface"><div class="header-wrapper"><h3 id="x3-3-interface"><bdi class="secno">3.3 </bdi>Interface</h3><a class="self-link" href="#interface" aria-label="Permalink for Section 3.3"></a></div>
<p>The interface <em><em class="rfc2119">MUST</em></em> have fields that can identify the request. </p>
<p>It is <em><em class="rfc2119">RECOMMENDED</em></em> to use [<cite><a class="bibref" data-link-type="biblio" href="#bib-trace-context" title="Trace Context">trace-context</a></cite>] to identify requests by implementing the following fields:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>trace_id</code></td>
<td>16 byte</td>
<td>Unique identifier of trace that follows data processing</td>
</tr>
<tr>
<td><code>span_id</code></td>
<td>8 byte</td>
<td>Unique identifier of span within the data processing</td>
</tr>
</tbody></table>
<p>When requests incorporate [<cite><a class="bibref" data-link-type="biblio" href="#bib-fsc - logging" title="FSC - Logging">FSC - Logging</a></cite>], the following field <em><em class="rfc2119">SHOULD</em></em> be implemented:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>transaction_id</code></td>
<td>string</td>
<td>Unique identifier of FSC transaction id of this request</td>
</tr>
</tbody></table>
<p>The interface <em><em class="rfc2119">MUST</em></em> implement the following fields describing the request and its response:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>timestamp</code></td>
<td>timestamp</td>
<td>The exact point in time when the authorization decision was made</td>
</tr>
<tr>
<td><code>type</code></td>
<td>string</td>
<td>The type of request as defined in the [<cite><a class="bibref" data-link-type="biblio" href="#bib-authzen" title="Authorization API 1.0 – draft 03">AuthZen</a></cite>] standard</td>
</tr>
<tr>
<td><code>request</code></td>
<td>object</td>
<td>Input for the decision in [<cite><a class="bibref" data-link-type="biblio" href="#bib-authzen" title="Authorization API 1.0 – draft 03">AuthZen</a></cite>] format</td>
</tr>
<tr>
<td><code>response</code></td>
<td>object</td>
<td>Output of the decision in [<cite><a class="bibref" data-link-type="biblio" href="#bib-authzen" title="Authorization API 1.0 – draft 03">AuthZen</a></cite>] format</td>
</tr>
</tbody></table>
<p>The interface <em><em class="rfc2119">MAY</em></em> implement the following fields:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>policies</code></td>
<td>object</td>
<td>Policy sources that affected the decision</td>
</tr>
<tr>
<td><code>information</code></td>
<td>object</td>
<td>Information sources used in the decision</td>
</tr>
<tr>
<td><code>configuration</code></td>
<td>object</td>
<td>Policy Decision Point configuration and metadata</td>
</tr>
</tbody></table>
<p>Implementations <em><em class="rfc2119">MAY</em></em> include additional fields. Such fields <em><em class="rfc2119">MUST NOT</em></em> alter the semantics of the defined fields and <em><em class="rfc2119">SHOULD</em></em> be ignored by recipients that do not recognize them.</p>
<section id="identifiers"><div class="header-wrapper"><h4 id="x3-3-1-identifiers"><bdi class="secno">3.3.1 </bdi>Identifiers</h4><a class="self-link" href="#identifiers" aria-label="Permalink for Section 3.3.1"></a></div>
<p>Each log record should be uniquely identified. Using these identifiers the log entry can be related to other logs and vice-versa.</p>
<p>The specification supports a number of different identifiers: a W3C Trace Context to integrate with [<cite><a class="bibref" data-link-type="biblio" href="#bib-logboek dataverwerkingen" title="Logboek dataverwerkingen">Logboek dataverwerkingen</a></cite>], a transaction id to integrate with [<cite><a class="bibref" data-link-type="biblio" href="#bib-fsc - logging" title="FSC - Logging">FSC - Logging</a></cite>], and a generic ID for when neither of the other identifiers are available.</p>
<section id="w3c-trace-context"><div class="header-wrapper"><h5 id="spec-trace-context"><bdi class="secno">3.3.1.1 </bdi>W3C Trace Context</h5><a class="self-link" href="#spec-trace-context" aria-label="Permalink for Section 3.3.1.1"></a></div><p>The <code>trace_id</code> field is a 16-byte unique identifier that represents the trace context for the data processing operation. This field <em><em class="rfc2119">SHOULD</em></em> follow the W3C Trace Context specification. The trace ID enables correlation of the authorization decision with related operations.</p>
<p>The <code>span_id</code> field is an 8-byte unique identifier that represents the specific span within the trace context. This field <em><em class="rfc2119">SHOULD</em></em> follow the W3C Trace Context specification. The span ID identifies the particular operation or step within the data processing flow where the authorization decision was made.</p>
</section><section id="fsc-transaction-id"><div class="header-wrapper"><h5 id="spec-fsc-transaction-id"><bdi class="secno">3.3.1.2 </bdi>FSC Transaction ID</h5><a class="self-link" href="#spec-fsc-transaction-id" aria-label="Permalink for Section 3.3.1.2"></a></div><p>The <code>transaction_id</code> field is a string value that represents the FSC transaction to which this request belongs. If a W3C trace context is available it should also be included.</p>
<div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="6"><span>Note</span></div><div class="">
The Authorization Decision Log and the FSC Log have the same granularity and can thus be combined into a single physical log. This specification ensures that no fields are defined that conflict with those defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-fsc - logging" title="FSC - Logging">FSC - Logging</a></cite>].
</div></div>

</section><section id="generic-identifier"><div class="header-wrapper"><h5 id="spec-generic-id"><bdi class="secno">3.3.1.3 </bdi>Generic identifier</h5><a class="self-link" href="#spec-generic-id" aria-label="Permalink for Section 3.3.1.3"></a></div><p>If none of the other identifiers can be supported, a generic fallback identifier can be included in the <code>id</code> field. </p>
<p>This can be any value, simple or complex, which can contain any kind of request identifier.</p>
</section></section><section id="request-and-response"><div class="header-wrapper"><h4 id="x3-3-2-request-and-response"><bdi class="secno">3.3.2 </bdi>Request and response</h4><a class="self-link" href="#request-and-response" aria-label="Permalink for Section 3.3.2"></a></div>
<p>The minimal information required for an entry in the log consists of a request for a decision and a response with the evaluated decision. </p>
<p>This section describes the key fields required for logging this request/response cycle.</p>
<section id="timestamp"><div class="header-wrapper"><h5 id="spec-timestamp"><bdi class="secno">3.3.2.1 </bdi>Timestamp</h5><a class="self-link" href="#spec-timestamp" aria-label="Permalink for Section 3.3.2.1"></a></div><p>The <code>timestamp</code> field represents the exact point in time when the authorization decision was made. The timestamp <em><em class="rfc2119">SHOULD</em></em> be in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3339" title="Date and Time on the Internet: Timestamps">RFC3339</a></cite>] format to ensure consistent interpretation across different systems and regions.</p>
</section><section id="type"><div class="header-wrapper"><h5 id="spec-type"><bdi class="secno">3.3.2.2 </bdi>Type</h5><a class="self-link" href="#spec-type" aria-label="Permalink for Section 3.3.2.2"></a></div><p>The <code>type</code> field represents the type of request that was made. This value identifies the AuthZEN endpoint that was invoked. </p>
<p>Its value <em><em class="rfc2119">MUST</em></em> be a string containing the key value of the relevant endpoint as defined in "Endpoint Parameters" of the "Policy Decision Point Metadata" as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-authzen" title="Authorization API 1.0 – draft 03">AuthZEN</a></cite>] with the <code>_endpoint</code> suffix omitted. </p>
<p>For example, a request to the URL defined by the <code>search_subject_endpoint</code> in the PDP metadata would have the <code>type</code> of <code>search_subject</code>.</p>
</section><section id="request"><div class="header-wrapper"><h5 id="spec-request"><bdi class="secno">3.3.2.3 </bdi>Request</h5><a class="self-link" href="#spec-request" aria-label="Permalink for Section 3.3.2.3"></a></div><p>The <code>request</code> field is an object that represents the input to the decision. This field <em><em class="rfc2119">MUST</em></em> be in [<cite><a class="bibref" data-link-type="biblio" href="#bib-authzen" title="Authorization API 1.0 – draft 03">AuthZen</a></cite>] format as defined for the given request type. </p>
<p>Portions of the request <em><em class="rfc2119">MAY</em></em> be omitted for privacy reasons. If information is omitted, this omission <em><em class="rfc2119">SHOULD</em></em> be documented or indicated in the log record. If the omitted information was used by the Policy Decision Point, then full accountability can no longer be provided.</p>
</section><section id="response"><div class="header-wrapper"><h5 id="spec-response"><bdi class="secno">3.3.2.4 </bdi>Response</h5><a class="self-link" href="#spec-response" aria-label="Permalink for Section 3.3.2.4"></a></div><p>The <code>response</code> field is an object that represents the output of the decision. This field <em><em class="rfc2119">MUST</em></em> be in [<cite><a class="bibref" data-link-type="biblio" href="#bib-authzen" title="Authorization API 1.0 – draft 03">AuthZen</a></cite>] format as defined for the given request type. </p>
<p>Portions of the response <em><em class="rfc2119">MAY</em></em> be omitted for privacy reasons. If information is omitted, this omission <em><em class="rfc2119">SHOULD</em></em> be documented or indicated in the log record. If information that was used by the Policy Enforcement Point is omitted then full accountability can no longer be provided.</p>
</section><section id="examples-non-normative"><div class="header-wrapper"><h5 id="x3-3-2-5-examples-non-normative"><bdi class="secno">3.3.2.5 </bdi>Examples (non-normative)</h5><a class="self-link" href="#examples-non-normative" aria-label="Permalink for Section 3.3.2.5"></a></div>
<p>In the following example a manager called Alice attempts to approve a holiday request for a team member called Bob, but the request is denied because she does not have signing authority. </p>
<p>Her browser submits the following request to the API:</p>
<aside class="example" id="example-http-request-for-holiday-approval"><div class="marker">
    <a class="self-link" href="#example-http-request-for-holiday-approval">Example<bdi> 1</bdi></a><span class="example-title">: HTTP request for holiday approval</span>
  </div>

<pre><code class="http hljs" aria-busy="false"><span class="hljs-keyword">POST</span> <span class="hljs-string">/users/bob/holiday-requests/446epbc8y7</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>hr.example.com
<span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>Bearer &lt;alice-auth-token&gt;
<span class="hljs-attribute">traceparent</span><span class="hljs-punctuation">: </span>00-28dbeec32e77635cc19bc3204ec56c41-dec5220770f8f4f4-01

<span class="language-json"><span class="hljs-punctuation">{</span><span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"approve"</span><span class="hljs-punctuation">}</span>
</span></code></pre>
</aside>

<p>The application, acting as the PEP, then submits the following HTTP request to the PDP:</p>
<aside class="example" id="example-http-request-from-the-pep-to-the-pdp"><div class="marker">
    <a class="self-link" href="#example-http-request-from-the-pep-to-the-pdp">Example<bdi> 2</bdi></a><span class="example-title">: HTTP request from the PEP to the PDP</span>
  </div>

<pre><code class="http hljs" aria-busy="false"><span class="hljs-keyword">POST</span> <span class="hljs-string">/access/v1/evaluation</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>pdp.example.com
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json
<span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>Bearer &lt;pep-auth-token&gt;
<span class="hljs-attribute">traceparent</span><span class="hljs-punctuation">: </span>00-28dbeec32e77635cc19bc3204ec56c41-893e1b2ac52d712f-01

<span class="language-json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"approve"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"holiday-request"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"446epbc8y7"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"employee"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bob"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"traceparent"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"00-28dbeec32e77635cc19bc3204ec56c41-dec5220770f8f4f4-01"</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</span></code></pre>
</aside>

<p>The PDP then determines that Alice can't sign on behalf of the company and thus cannot approve the holiday request. It returns the following response:</p>
<aside class="example" id="example-response-from-the-pdp-to-the-pep"><div class="marker">
    <a class="self-link" href="#example-response-from-the-pdp-to-the-pep">Example<bdi> 3</bdi></a><span class="example-title">: Response from the PDP to the PEP</span>
  </div>

<pre><code class="json hljs" aria-busy="false"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"48"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"No signing authority"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</aside>

<p>The following JSON object contains a non-normative example of a log record describing this example:</p>
<aside class="example" id="example-log-record-of-denied-holiday-approval"><div class="marker">
    <a class="self-link" href="#example-log-record-of-denied-holiday-approval">Example<bdi> 4</bdi></a><span class="example-title">: Log record of denied holiday approval</span>
  </div>

<pre><code class="json hljs" aria-busy="false"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-09-07T10:14:18Z"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"28dbeec32e77635cc19bc3204ec56c41"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"span_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"893e1b2ac52d712f"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"evaluation"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"request"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"approve"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"holiday-request"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"446epbc8y7"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"employee"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bob"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"traceparent"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"00-28dbeec32e77635cc19bc3204ec56c41-dec5220770f8f4f4-01"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"response"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"48"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"No signing authority"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</aside>

</section></section><section id="policy-sources"><div class="header-wrapper"><h4 id="spec-policies"><bdi class="secno">3.3.3 </bdi>Policy Sources</h4><a class="self-link" href="#spec-policies" aria-label="Permalink for Section 3.3.3"></a></div><p>The <code>policies</code> field represents a versioned reference to the policies that the PDP used to evaluate the request. In a PxP architecture, this represents the information that would come from the Policy Administration Point (PAP).</p>
<p>A PDP can have one or more sources of policies which can be individually versioned. To accommodate that the <code>policies</code> field is an object in which each key identifies a specific, versioned, policy source. </p>
<p>All policy sources that have affected the decision <em><em class="rfc2119">MUST</em></em> be included. The value associated with each key refers to a unique version of the policy source. The information in this field <em><em class="rfc2119">MUST</em></em> be sufficient to retrieve all policies from the policy sources that were used in the authorization decision.</p>
<p>Non-normative examples include:</p>
<ul>
<li>Timestamp</li>
<li>Unique identifier</li>
<li>Semantic version</li>
<li>Git hash</li>
</ul>
<section id="examples-non-normative-0"><div class="header-wrapper"><h5 id="x3-3-3-1-examples-non-normative"><bdi class="secno">3.3.3.1 </bdi>Examples (non-normative)</h5><a class="self-link" href="#examples-non-normative-0" aria-label="Permalink for Section 3.3.3.1"></a></div>
<p>We can extend the example of the holiday-approval request by adding a reference to a Git repository in which current HR approval policies are documented. In the example below the git hash of the version currently deployed together with the PDP is <code>6266d07750c44b4c9b05d0801b752c0ef884e4f6</code>.</p>
<aside class="example" id="example-git-versioned-policy-source"><div class="marker">
    <a class="self-link" href="#example-git-versioned-policy-source">Example<bdi> 5</bdi></a><span class="example-title">: Git-versioned policy source</span>
  </div>

<pre><code class="json hljs" aria-busy="false"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"hr"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"6266d07750c44b4c9b05d0801b752c0ef884e4f6"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</aside>

<p>More complex references can be achieved by using an object as the version identifier. If, for example, the HR application takes part in a federation with predefined policies for different maturity levels. The following non-normative example shows how those policies can be referenced using a semantic version combined with a filter for policies relevant to the current maturity level.</p>
<aside class="example" id="example-complex-policy-source-reference"><div class="marker">
    <a class="self-link" href="#example-complex-policy-source-reference">Example<bdi> 6</bdi></a><span class="example-title">: Complex policy source reference</span>
  </div>

<pre><code class="json hljs" aria-busy="false"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"hr"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"6266d07750c44b4c9b05d0801b752c0ef884e4f6"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"federation"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.7.1"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"filter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"maturity_level &lt;= 3"</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</aside>

<p>The following JSON object contains a non-normative example of a log record describing this example:</p>
<aside class="example" id="example-log-record-of-denied-holiday-approval-0"><div class="marker">
    <a class="self-link" href="#example-log-record-of-denied-holiday-approval-0">Example<bdi> 7</bdi></a><span class="example-title">: Log record of denied holiday approval</span>
  </div>

<pre><code class="json hljs" aria-busy="false"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-09-07T10:14:18Z"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"28dbeec32e77635cc19bc3204ec56c41"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"span_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"893e1b2ac52d712f"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"evaluation"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"request"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"approve"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"holiday-request"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"446epbc8y7"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"employee"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bob"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"traceparent"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"00-28dbeec32e77635cc19bc3204ec56c41-dec5220770f8f4f4-01"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"response"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"48"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"No signing authority"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"policies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"hr"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"6266d07750c44b4c9b05d0801b752c0ef884e4f6"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"federation"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.7.1"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"filter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"maturity_level &lt;= 3"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</aside>


</section></section><section id="information-sources"><div class="header-wrapper"><h4 id="spec-information"><bdi class="secno">3.3.4 </bdi>Information Sources</h4><a class="self-link" href="#spec-information" aria-label="Permalink for Section 3.3.4"></a></div><p>The <code>information</code> field represents all the supporting information used in the evaluation of the access decision. In a PxP architecture, this field represents the information that would come from Policy Information Points (PIPs).</p>
<p>It is an object in which each key identifies an information source. All information sources that have affected the decision <em><em class="rfc2119">SHOULD</em></em> be included. The value of this field <em><em class="rfc2119">SHOULD</em></em> either contain the information that was used in the access decision or be sufficient to retrieve the information. </p>
<section id="examples-non-normative-1"><div class="header-wrapper"><h5 id="x3-3-4-1-examples-non-normative"><bdi class="secno">3.3.4.1 </bdi>Examples (non-normative)</h5><a class="self-link" href="#examples-non-normative-1" aria-label="Permalink for Section 3.3.4.1"></a></div>
<p>In the example of the holiday approval, the ability to sign is accessed through the <code>can_sign</code> field of the user. The Policy Information Point (PIP) called <code>can-sign-api</code> requests this via an API from the HR application using the request below:</p>
<aside class="example" id="example-pip-s-request-to-the-managers-api"><div class="marker">
    <a class="self-link" href="#example-pip-s-request-to-the-managers-api">Example<bdi> 8</bdi></a><span class="example-title">: PIP's request to the Managers API</span>
  </div>

<pre><code class="http hljs" aria-busy="false"><span class="hljs-keyword">GET</span> <span class="hljs-string">/users/alice?fields=can_sign</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>hr.example.com
<span class="hljs-attribute">traceparent</span><span class="hljs-punctuation">: </span>00-28dbeec32e77635cc19bc3204ec56c41-836ff5286112f460-01
</code></pre>
</aside>

<p>And the API returns the following response.</p>
<aside class="example" id="example-managers-api-response-to-the-pip-s-request"><div class="marker">
    <a class="self-link" href="#example-managers-api-response-to-the-pip-s-request">Example<bdi> 9</bdi></a><span class="example-title">: Managers API response to the PIP's request</span>
  </div>

<pre><code class="json hljs" aria-busy="false"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"can_sign"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
</aside>

<p>The following JSON object contains a non-normative example of a log record describing this example. </p>
<aside class="example" id="example-log-record-of-denied-holiday-approval-1"><div class="marker">
    <a class="self-link" href="#example-log-record-of-denied-holiday-approval-1">Example<bdi> 10</bdi></a><span class="example-title">: Log record of denied holiday approval</span>
  </div>

<pre><code class="json hljs" aria-busy="false"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-09-07T10:14:18Z"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"28dbeec32e77635cc19bc3204ec56c41"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"span_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"893e1b2ac52d712f"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"evaluation"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"request"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"approve"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"holiday-request"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"446epbc8y7"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"employee"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bob"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"traceparent"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"00-28dbeec32e77635cc19bc3204ec56c41-dec5220770f8f4f4-01"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"response"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"48"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"No signing authority"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"policies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"hr"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"6266d07750c44b4c9b05d0801b752c0ef884e4f6"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"federation"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.7.1"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"filter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"maturity_level &lt;= 3"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"information"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"can-sign-api"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"can_sign"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</aside>

<div class="note" role="note" id="issue-container-generatedID-3"><div role="heading" class="note-title marker" id="h-note-3" aria-level="6"><span>Note</span><span class="issue-label">: Source references to reduce data duplication</span></div><p class="">
In this example the entire response is stored in the log record as it is a small response without sensitive data. In most cases it is recommended to use a reference to the data instead. See <a href="#source-references" data-matched-text="[[[#source-references]]]" class="sec-ref"><bdi class="secno">3.4 </bdi>Sources and referencing</a> for more information.
</p></div>

</section></section><section id="configuration-sources"><div class="header-wrapper"><h4 id="spec-configuration"><bdi class="secno">3.3.5 </bdi>Configuration Sources</h4><a class="self-link" href="#spec-configuration" aria-label="Permalink for Section 3.3.5"></a></div><p>The <code>configuration</code> field represents the information required to recreate the software configuration that evaluated the original decision. In a PxP architecture, this primarily represents the configuration of the Policy Decision Point (PDP), but <em><em class="rfc2119">MAY</em></em> also include configuration of Policy Information Points (PIPs) and Policy Administration Points (PAPs).</p>
<p>It is an object in which each key identifies a configuration source. All configuration sources that have affected the decision <em><em class="rfc2119">SHOULD</em></em> be included. The value of this field <em><em class="rfc2119">SHOULD</em></em> either contain the configuration that was used in the access decision or be sufficient to retrieve the configuration.</p>
<p>Non-normative examples include:</p>
<ul>
<li>Configuration of the policy engine (PDP)</li>
<li>Version of the policy language</li>
<li>Identifier or hostname of the PDP in case multiple PDPs are used</li>
<li>Configuration of Policy Information Points, such as API endpoints.</li>
<li>Git hash of an IaaS definition, such as a Terraform repository.</li>
</ul>
<section id="examples-non-normative-2"><div class="header-wrapper"><h5 id="x3-3-5-1-examples-non-normative"><bdi class="secno">3.3.5.1 </bdi>Examples (non-normative)</h5><a class="self-link" href="#examples-non-normative-2" aria-label="Permalink for Section 3.3.5.1"></a></div>
<p>In the example below we extend the holiday approval request example by describing the version of the language used by the PDP and the configuration of the <code>can-sign-api</code> PIP.</p>
<aside class="example" id="example-log-record-of-denied-holiday-approval-2"><div class="marker">
    <a class="self-link" href="#example-log-record-of-denied-holiday-approval-2">Example<bdi> 11</bdi></a><span class="example-title">: Log record of denied holiday approval</span>
  </div>

<pre><code class="json hljs" aria-busy="false"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-09-07T10:14:18Z"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"28dbeec32e77635cc19bc3204ec56c41"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"span_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"893e1b2ac52d712f"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"evaluation"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"request"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"approve"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"holiday-request"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"446epbc8y7"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"employee"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bob"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"traceparent"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"00-28dbeec32e77635cc19bc3204ec56c41-dec5220770f8f4f4-01"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"response"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"48"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"No signing authority"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"policies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"hr"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"6266d07750c44b4c9b05d0801b752c0ef884e4f6"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"federation"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.7.1"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"filter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"maturity_level &lt;= 3"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"information"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"can-sign-api"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"can_sign"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"configuration"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"opa_version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.10.0"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"can-sign-api"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://hr.example.com/users/{subject.id}?fields=can_sign"</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</aside>

<div class="note" role="note" id="issue-container-generatedID-4"><div role="heading" class="note-title marker" id="h-note-4" aria-level="6"><span>Note</span><span class="issue-label">: Source references to reduce data duplication</span></div><p class="">
In this example the configuration is stored in the log record itself. To reduce data duplication it is generally recommended to use a reference to the configuration instead. See <a href="#source-references" data-matched-text="[[[#source-references]]]" class="sec-ref"><bdi class="secno">3.4 </bdi>Sources and referencing</a> for more information.
</p></div>

</section></section></section><section id="sources-and-referencing"><div class="header-wrapper"><h3 id="source-references"><bdi class="secno">3.4 </bdi>Sources and referencing</h3><a class="self-link" href="#source-references" aria-label="Permalink for Section 3.4"></a></div><p>Policy, information and configuration sources <em><em class="rfc2119">MAY</em></em> be included in the log directly.</p>
<p>This is generally undesirable however as it introduces duplication, increases the size of the log and increase security requirements for the log by including sensitive data.</p>
<p>To address this we describe several methods of referencing sources from the log below.</p>
<section id="versioned-sources"><div class="header-wrapper"><h4 id="x3-4-1-versioned-sources"><bdi class="secno">3.4.1 </bdi>Versioned sources</h4><a class="self-link" href="#versioned-sources" aria-label="Permalink for Section 3.4.1"></a></div>
<p>Some information sources offer the ability to 'time-travel' by providing a version at which to query. In such cases, the data itself may be omitted and the version can be stored instead.  </p>
<p>The version identifier can be a simple value, such as a string or number, or a complex object, such as an array or object containing multiple version identifiers.</p>
<p>The following non-normative example shows a reference to a specific semantic version of a policy source.</p>
<aside class="example" id="example-policy-source-reference-using-semantic-versioning"><div class="marker">
    <a class="self-link" href="#example-policy-source-reference-using-semantic-versioning">Example<bdi> 12</bdi></a><span class="example-title">: Policy source reference using semantic versioning</span>
  </div>

<pre><code class="json hljs" aria-busy="false"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"traffic-policy"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gmb-2025-94604@1.1"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</aside>

<p>In a complex case, such as limiting requests for open data per IP per minute across a large number of servers, the version could also consist of an array of partition offsets in a Kafka stream of HTTP request.</p>
<aside class="example" id="example-complex-versioned-information-sources-using-kafka-partition-offsets"><div class="marker">
    <a class="self-link" href="#example-complex-versioned-information-sources-using-kafka-partition-offsets">Example<bdi> 13</bdi></a><span class="example-title">: Complex versioned information sources using Kafka partition offsets</span>
  </div>

<pre><code class="json hljs" aria-busy="false"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"nginx-requests"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span> <span class="hljs-number">8376912</span><span class="hljs-punctuation">,</span> <span class="hljs-number">8368118</span><span class="hljs-punctuation">,</span> <span class="hljs-number">8377785</span><span class="hljs-punctuation">,</span> <span class="hljs-number">8386285</span><span class="hljs-punctuation">,</span> <span class="hljs-number">8383526</span> <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</aside>

</section><section id="temporal-sources"><div class="header-wrapper"><h4 id="x3-4-2-temporal-sources"><bdi class="secno">3.4.2 </bdi>Temporal sources</h4><a class="self-link" href="#temporal-sources" aria-label="Permalink for Section 3.4.2"></a></div>
<p>In case the source of information offers the ability to 'time-travel' by providing a timestamp at which to query, then the data itself may be omitted. </p>
<p>It is <em><em class="rfc2119">RECOMMENDED</em></em> to use the timestamp defined in the <code>time</code> field in the <code>context</code> of the <code>request</code> as the base time. In that case the information source <em><em class="rfc2119">MAY</em></em> be omitted fully. </p>
<p>If a different timestamp is used, then it <em><em class="rfc2119">SHOULD</em></em> be included in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3339" title="Date and Time on the Internet: Timestamps">RFC3339</a></cite>] format.</p>
<div class="note" role="note" id="issue-container-generatedID-5"><div role="heading" class="note-title marker" id="h-note-5" aria-level="5"><span>Note</span><span class="issue-label">: Inter-system clock inconsistencies</span></div><p class="">
When system clocks are not aligned properly, a system may be asked to provide information for a timestamp that lies in the future. This can be mitigated by requesting the policies of a few seconds or minutes ago at the expense of reducing the speed with which policy changes can be deployed.
</p></div>

<div class="note" role="note" id="issue-container-generatedID-6"><div role="heading" class="note-title marker" id="h-note-6" aria-level="5"><span>Note</span><span class="issue-label">: Usage of REST API Design Rules</span></div><p class="">
In the context of REST APIs developed by the Dutch government the <a href="https://docs.geostandaarden.nl/api/API-Strategie-ext/#temporal">Temporal extension</a> of the [<cite><a class="bibref" data-link-type="biblio" href="#bib-rest api design rules" title="NLGov REST API Design Rules 2.0.0">REST API Design Rules</a></cite>] can be used for this purpose.
</p></div>

</section><section id="logged-sources"><div class="header-wrapper"><h4 id="x3-4-3-logged-sources"><bdi class="secno">3.4.3 </bdi>Logged sources</h4><a class="self-link" href="#logged-sources" aria-label="Permalink for Section 3.4.3"></a></div>
<p>For information sources that are logged in an external log, a request identifier is needed to look up the corresponding request in the external log.</p>
<p>It is <em><em class="rfc2119">RECOMMENDED</em></em> to use the W3C Trace Context standard as the request identifier. Such a request <em><em class="rfc2119">SHOULD</em></em> have the same <code>trace_id</code> as the request to the PDP, in which case the source reference can consist of only the value of the <code>span_id</code>.</p>
<p>It is <em><em class="rfc2119">RECOMMENDED</em></em> to log requests in the [<cite><a class="bibref" data-link-type="biblio" href="#bib-warc" title="Information and documentation — WARC file format">WARC</a></cite>] format as it includes all request and response headers that may be used in the authorization decision.</p>
<p>The following non-normative example shows a log record for a request to find all subjects capable of approving a holiday request:</p>
<aside class="example" id="example-log-record-of-a-search-request-for-managers-with-approval-rights"><div class="marker">
    <a class="self-link" href="#example-log-record-of-a-search-request-for-managers-with-approval-rights">Example<bdi> 14</bdi></a><span class="example-title">: Log record of a search request for managers with approval rights</span>
  </div>

<pre><code class="json hljs" aria-busy="false"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-09-07T10:15:36Z"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"28dbeec32e77635cc19bc3204ec56c41"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"span_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"17c59821784ee492"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"search_subject"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"request"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"approve"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"holiday-request"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"446epbc8y7"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"employee"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bob"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"response"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"results"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"carol"</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dan"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"policies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"git"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"e4c15a063048367da367d5588d703b5e4a6b760e"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"information"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"managers-api"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"45deb36022f53afa"</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</aside>

<p>Which would result in the following WARC entries logging the REST API call to the HR system:</p>
<aside class="example" id="example-warc-entries-for-rest-api-call-to-hr-system"><div class="marker">
    <a class="self-link" href="#example-warc-entries-for-rest-api-call-to-hr-system">Example<bdi> 15</bdi></a><span class="example-title">: WARC entries for REST API call to HR system</span>
  </div>

<pre><code class="warc hljs" aria-busy="false">WARC/1.1
WARC-Type: request
WARC-Date: 2025-09-07T10:15:31Z
WARC-Record-ID: &lt;urn:uuid:48bafbce-8d2a-45c1-9d7a-1a851c36e1c8&gt;
Content-Type: application/http; msgtype=request
Content-Length: 142

GET /users/bob/managers?fields=can_sign HTTP/1.1
Host: hr.example.com
traceparent: 00-28dbeec32e77635cc19bc3204ec56c41-45deb36022f53afa-01

WARC/1.1
WARC-Type: response
WARC-Date: 2025-09-07T10:15:32Z
WARC-Record-ID: &lt;urn:uuid:4a381180-21a7-4712-8706-5b321c17e3f8&gt;
WARC-Concurrent-To: &lt;urn:uuid:48bafbce-8d2a-45c1-9d7a-1a851c36e1c8&gt;
Content-Type: application/http; msgtype=response
Content-Length: 175

HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 107

{
    "alice": {
        "can_sign": false
    },
    "carol": {
        "can_sign": true
    },
    "dan": {
        "can_sign": true
    }
}
</code></pre>
</aside></section></section></section><section class="levels-of-detail" id="data-verifiability-and-level-of-detail"><div class="header-wrapper"><h2 id="x4-data-verifiability-and-level-of-detail"><bdi class="secno">4. </bdi>Data Verifiability and Level of Detail</h2><a class="self-link" href="#data-verifiability-and-level-of-detail" aria-label="Permalink for Section 4."></a></div>
<p>The ability to provide accountability depends on the log's level of detail. A balance must be struck between capturing enough information to accurately replay historical decisions and practical challenges like data duplication and scalability. The appropriate level of detail depends on the organization's specific context and legal requirements, as the highest level is not always necessary.</p>
<p>To ensure historical accuracy while minimizing data storage, referencing external information (e.g., via a timestamp or version number) is preferred over storing copies. This approach keeps logs lean but is contingent on the ability of source systems to provide versioned historical data.</p>
<p>For full replayability, the log must also identify the exact version and configuration of the policy engine that evaluated the decision; however, providing reliable versioning for the engine may not always be feasible, depending on the infrastructure.</p>
<section id="definition-of-levels"><div class="header-wrapper"><h3 id="x4-1-definition-of-levels"><bdi class="secno">4.1 </bdi>Definition of Levels</h3><a class="self-link" href="#definition-of-levels" aria-label="Permalink for Section 4.1"></a></div>
<p>We have identified four levels of detail, in order from least to most detail. Each level builds on the information from the previous level.</p>
<section id="level-1-decision-request-response"><div class="header-wrapper"><h4 id="x4-1-1-level-1-decision-request-response"><bdi class="secno">4.1.1 </bdi>Level 1: Decision Request/Response</h4><a class="self-link" href="#level-1-decision-request-response" aria-label="Permalink for Section 4.1.1"></a></div>
<p>At the most basic level only the decision request and the decision response are logged.</p>
<div class="note" role="note" id="issue-container-generatedID-7"><div role="heading" class="note-title marker" id="h-note-7" aria-level="5"><span>Note</span><span class="issue-label">: Engine boundaries</span></div><p class="">
The decision request and response <i><em class="rfc2119">MAY</em></i> contain all information required for an audit log, as described by [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso/iec 27002:2022" title="Information security, cybersecurity and privacy protection — Information security controls">ISO/IEC 27002:2022</a></cite>] and [<cite><a class="bibref" data-link-type="biblio" href="#bib-bio2" title="Baseline Informatiebeveiliging Overheid 2">BIO2</a></cite>]. If that is the case, and all auditable actions are decided on by the PDP, the Authorization Decision Log <i><em class="rfc2119">MAY</em></i> be used as an audit log.
</p></div>

<p>At this level of detail log requests contain the following keys, as defined in <a href="#specifications" data-matched-text="[[[#specifications]]]" class="sec-ref"><bdi class="secno">3. </bdi>Specifications</a>:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Required</th>
<th>Reference</th>
</tr>
</thead>
<tbody><tr>
<td><code>trace_id</code></td>
<td>optional</td>
<td><a href="#spec-trace-context" data-matched-text="[[[#spec-trace-context]]]" class="sec-ref"><bdi class="secno">3.3.1.1 </bdi>W3C Trace Context</a></td>
</tr>
<tr>
<td><code>span_id</code></td>
<td>optional</td>
<td><a href="#spec-trace-context" data-matched-text="[[[#spec-trace-context]]]" class="sec-ref"><bdi class="secno">3.3.1.1 </bdi>W3C Trace Context</a></td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>required</td>
<td><a href="#spec-timestamp" data-matched-text="[[[#spec-timestamp]]]" class="sec-ref"><bdi class="secno">3.3.2.1 </bdi>Timestamp</a></td>
</tr>
<tr>
<td><code>type</code></td>
<td>required</td>
<td><a href="#spec-type" data-matched-text="[[[#spec-type]]]" class="sec-ref"><bdi class="secno">3.3.2.2 </bdi>Type</a></td>
</tr>
<tr>
<td><code>request</code></td>
<td>required</td>
<td><a href="#spec-request" data-matched-text="[[[#spec-request]]]" class="sec-ref"><bdi class="secno">3.3.2.3 </bdi>Request</a></td>
</tr>
<tr>
<td><code>response</code></td>
<td>required</td>
<td><a href="#spec-response" data-matched-text="[[[#spec-response]]]" class="sec-ref"><bdi class="secno">3.3.2.4 </bdi>Response</a></td>
</tr>
</tbody></table>
</section><section id="level-2-decision-and-policies"><div class="header-wrapper"><h4 id="x4-1-2-level-2-decision-and-policies"><bdi class="secno">4.1.2 </bdi>Level 2: Decision and Policies</h4><a class="self-link" href="#level-2-decision-and-policies" aria-label="Permalink for Section 4.1.2"></a></div>
<p>In addition to the request and response, the exact version of the policies that were used to evaluate the request can be programmatically retrieved.</p>
<p>At this level of detail log requests contain the following keys, as defined in <a href="#specifications" data-matched-text="[[[#specifications]]]" class="sec-ref"><bdi class="secno">3. </bdi>Specifications</a>:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Required</th>
<th>Reference</th>
</tr>
</thead>
<tbody><tr>
<td><code>trace_id</code></td>
<td>optional</td>
<td><a href="#spec-trace-context" data-matched-text="[[[#spec-trace-context]]]" class="sec-ref"><bdi class="secno">3.3.1.1 </bdi>W3C Trace Context</a></td>
</tr>
<tr>
<td><code>span_id</code></td>
<td>optional</td>
<td><a href="#spec-trace-context" data-matched-text="[[[#spec-trace-context]]]" class="sec-ref"><bdi class="secno">3.3.1.1 </bdi>W3C Trace Context</a></td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>required</td>
<td><a href="#spec-timestamp" data-matched-text="[[[#spec-timestamp]]]" class="sec-ref"><bdi class="secno">3.3.2.1 </bdi>Timestamp</a></td>
</tr>
<tr>
<td><code>type</code></td>
<td>required</td>
<td><a href="#spec-type" data-matched-text="[[[#spec-type]]]" class="sec-ref"><bdi class="secno">3.3.2.2 </bdi>Type</a></td>
</tr>
<tr>
<td><code>request</code></td>
<td>required</td>
<td><a href="#spec-request" data-matched-text="[[[#spec-request]]]" class="sec-ref"><bdi class="secno">3.3.2.3 </bdi>Request</a></td>
</tr>
<tr>
<td><code>response</code></td>
<td>required</td>
<td><a href="#spec-response" data-matched-text="[[[#spec-response]]]" class="sec-ref"><bdi class="secno">3.3.2.4 </bdi>Response</a></td>
</tr>
<tr>
<td><code>policies</code></td>
<td>required</td>
<td><a href="#spec-policies" data-matched-text="[[[#spec-policies]]]" class="sec-ref"><bdi class="secno">3.3.3 </bdi>Policy Sources</a></td>
</tr>
</tbody></table>
</section><section id="level-3-all-information-sources"><div class="header-wrapper"><h4 id="x4-1-3-level-3-all-information-sources"><bdi class="secno">4.1.3 </bdi>Level 3: All Information Sources</h4><a class="self-link" href="#level-3-all-information-sources" aria-label="Permalink for Section 4.1.3"></a></div>
<p>All information used in the evaluation can be programmatically retrieved. This allows full replayability, assuming the engine (PDP) behaves identically or can be manually recreated in the correct state, which is generally achievable.</p>
<p>At this level of detail log requests contain the following keys, as defined in <a href="#specifications" data-matched-text="[[[#specifications]]]" class="sec-ref"><bdi class="secno">3. </bdi>Specifications</a>:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Required</th>
<th>Reference</th>
</tr>
</thead>
<tbody><tr>
<td><code>trace_id</code></td>
<td>optional</td>
<td><a href="#spec-trace-context" data-matched-text="[[[#spec-trace-context]]]" class="sec-ref"><bdi class="secno">3.3.1.1 </bdi>W3C Trace Context</a></td>
</tr>
<tr>
<td><code>span_id</code></td>
<td>optional</td>
<td><a href="#spec-trace-context" data-matched-text="[[[#spec-trace-context]]]" class="sec-ref"><bdi class="secno">3.3.1.1 </bdi>W3C Trace Context</a></td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>required</td>
<td><a href="#spec-timestamp" data-matched-text="[[[#spec-timestamp]]]" class="sec-ref"><bdi class="secno">3.3.2.1 </bdi>Timestamp</a></td>
</tr>
<tr>
<td><code>type</code></td>
<td>required</td>
<td><a href="#spec-type" data-matched-text="[[[#spec-type]]]" class="sec-ref"><bdi class="secno">3.3.2.2 </bdi>Type</a></td>
</tr>
<tr>
<td><code>request</code></td>
<td>required</td>
<td><a href="#spec-request" data-matched-text="[[[#spec-request]]]" class="sec-ref"><bdi class="secno">3.3.2.3 </bdi>Request</a></td>
</tr>
<tr>
<td><code>response</code></td>
<td>required</td>
<td><a href="#spec-response" data-matched-text="[[[#spec-response]]]" class="sec-ref"><bdi class="secno">3.3.2.4 </bdi>Response</a></td>
</tr>
<tr>
<td><code>policies</code></td>
<td>required</td>
<td><a href="#spec-policies" data-matched-text="[[[#spec-policies]]]" class="sec-ref"><bdi class="secno">3.3.3 </bdi>Policy Sources</a></td>
</tr>
<tr>
<td><code>information</code></td>
<td>required</td>
<td><a href="#spec-information" data-matched-text="[[[#spec-information]]]" class="sec-ref"><bdi class="secno">3.3.4 </bdi>Information Sources</a></td>
</tr>
</tbody></table>
</section><section id="level-4-full-environment"><div class="header-wrapper"><h4 id="x4-1-4-level-4-full-environment"><bdi class="secno">4.1.4 </bdi>Level 4: Full Environment</h4><a class="self-link" href="#level-4-full-environment" aria-label="Permalink for Section 4.1.4"></a></div>
<p>In addition to all information used in the evaluation, the environment and configuration of the system that evaluates the decision can also be accurately recreated. This provides full, guaranteed replayability and maximum accountability.</p>
<div class="note" role="note" id="issue-container-generatedID-8"><div role="heading" class="note-title marker" id="h-note-8" aria-level="5"><span>Note</span><span class="issue-label">: System boundaries</span></div><p class="">
The configuration of all components that influence the decision should be included. While this may be limited to the configuration of the PDP, it often also requires configuration of the PIP and sometimes the PAP as well.
</p></div>

<p>At this level of detail log requests contain the following keys, as defined in <a href="#specifications" data-matched-text="[[[#specifications]]]" class="sec-ref"><bdi class="secno">3. </bdi>Specifications</a>:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Required</th>
<th>Reference</th>
</tr>
</thead>
<tbody><tr>
<td><code>trace_id</code></td>
<td>optional</td>
<td><a href="#spec-trace-context" data-matched-text="[[[#spec-trace-context]]]" class="sec-ref"><bdi class="secno">3.3.1.1 </bdi>W3C Trace Context</a></td>
</tr>
<tr>
<td><code>span_id</code></td>
<td>optional</td>
<td><a href="#spec-trace-context" data-matched-text="[[[#spec-trace-context]]]" class="sec-ref"><bdi class="secno">3.3.1.1 </bdi>W3C Trace Context</a></td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>required</td>
<td><a href="#spec-timestamp" data-matched-text="[[[#spec-timestamp]]]" class="sec-ref"><bdi class="secno">3.3.2.1 </bdi>Timestamp</a></td>
</tr>
<tr>
<td><code>type</code></td>
<td>required</td>
<td><a href="#spec-type" data-matched-text="[[[#spec-type]]]" class="sec-ref"><bdi class="secno">3.3.2.2 </bdi>Type</a></td>
</tr>
<tr>
<td><code>request</code></td>
<td>required</td>
<td><a href="#spec-request" data-matched-text="[[[#spec-request]]]" class="sec-ref"><bdi class="secno">3.3.2.3 </bdi>Request</a></td>
</tr>
<tr>
<td><code>response</code></td>
<td>required</td>
<td><a href="#spec-response" data-matched-text="[[[#spec-response]]]" class="sec-ref"><bdi class="secno">3.3.2.4 </bdi>Response</a></td>
</tr>
<tr>
<td><code>policies</code></td>
<td>required</td>
<td><a href="#spec-policies" data-matched-text="[[[#spec-policies]]]" class="sec-ref"><bdi class="secno">3.3.3 </bdi>Policy Sources</a></td>
</tr>
<tr>
<td><code>information</code></td>
<td>required</td>
<td><a href="#spec-information" data-matched-text="[[[#spec-information]]]" class="sec-ref"><bdi class="secno">3.3.4 </bdi>Information Sources</a></td>
</tr>
<tr>
<td><code>configuration</code></td>
<td>required</td>
<td><a href="#spec-configuration" data-matched-text="[[[#spec-configuration]]]" class="sec-ref"><bdi class="secno">3.3.5 </bdi>Configuration Sources</a></td>
</tr>
</tbody></table>
</section></section><section id="implications-of-levels"><div class="header-wrapper"><h3 id="x4-2-implications-of-levels"><bdi class="secno">4.2 </bdi>Implications of levels</h3><a class="self-link" href="#implications-of-levels" aria-label="Permalink for Section 4.2"></a></div>
<p>The higher the level of detail, the more useful the log is for determining the context of an authorization decision. On the other hand, higher levels of detail also introduce challenges around scalability, technical feasibility, and security.</p>
<p>Conversely, the lowest level of detail may not be sufficient to provide effective accountability. This depends on the data processing which is being authorized and legal requirements for it.</p>
<p>For that reason it's important to decide for different use cases which level of detail is required and appropriate. Aiming for the highest level of detail for all authorization decisions is thus not necessary.</p>
</section></section><section class="information-management" id="information-management-and-compliance"><div class="header-wrapper"><h2 id="information-management"><bdi class="secno">5. </bdi>Information Management and Compliance</h2><a class="self-link" href="#information-management" aria-label="Permalink for Section 5."></a></div><p>This, non-authoritative, section addresses the governance, security, and privacy-compliance aspects of managing an Authorization Decision Log (ADL).</p>
<p>Conformance to this standard does not, by itself, guarantee legal or regulatory compliance. The implementing organization is solely responsible for ensuring its implementation adheres to all applicable frameworks, such as the General Data Protection Regulation (GDPR / AVG) and relevant security baselines, such as [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso/iec 27001:2022" title="Information security, cybersecurity and privacy protection — Information security management systems — Requirements">ISO/IEC 27001:2022</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso/iec 27002:2022" title="Information security, cybersecurity and privacy protection — Information security controls">ISO/IEC 27002:2022</a></cite>], and [<cite><a class="bibref" data-link-type="biblio" href="#bib-bio2" title="Baseline Informatiebeveiliging Overheid 2">BIO2</a></cite>]. Each organization is responsible for its own Authorization Decision Log. There is no central log, although logs of several organizations can be aggregated if desired.</p>
<p>The following sections list aspects that should be taken into consideration when creating a compliant and secure logging solution.</p>
<section id="legal-and-privacy-compliance"><div class="header-wrapper"><h3 id="x5-1-legal-and-privacy-compliance"><bdi class="secno">5.1 </bdi>Legal and Privacy Compliance</h3><a class="self-link" href="#legal-and-privacy-compliance" aria-label="Permalink for Section 5.1"></a></div>
<p>Logging authorization decisions creates a new processing of data, which must be compliant with privacy regulations if personal data is involved.</p>
<section id="purpose-limitation"><div class="header-wrapper"><h4 id="x5-1-1-purpose-limitation"><bdi class="secno">5.1.1 </bdi>Purpose Limitation</h4><a class="self-link" href="#purpose-limitation" aria-label="Permalink for Section 5.1.1"></a></div>
<p>When collecting personal data, the specific purposes for logging (e.g., operational auditing, forensic analysis, citizen accountability) must be defined and documented in a formal policy before implementation. Data collection must be limited to these defined purposes.</p>
</section><section id="data-minimization"><div class="header-wrapper"><h4 id="x5-1-2-data-minimization"><bdi class="secno">5.1.2 </bdi>Data Minimization</h4><a class="self-link" href="#data-minimization" aria-label="Permalink for Section 5.1.2"></a></div>
<p>A core principle is to avoid storing unnecessary information, especially sensitive data. The goal is to make the log precise, compact, and manageable. Instead of duplicating large amounts of (personal) data, prefer storing only the data used in the decision or even just a reference that allows the state at the time of the decision to be recreated.</p>
<p>A logging policy must be implemented to manage what is logged based on risk. When logging sensitive data for high-risk use cases, this should be explicitly documented and approved.</p>
<p>Implementers should consider pseudonymization and anonymization for personal data. For example, personal identifiers can be hashed or aliased and location data can be randomized.</p>
<p>When aggregate statistics, such as decisions per type per time period, are sufficient, implementers should consider using aggregation as a method of data minimization and anonymization.</p>
</section><section id="data-retention"><div class="header-wrapper"><h4 id="x5-1-3-data-retention"><bdi class="secno">5.1.3 </bdi>Data Retention</h4><a class="self-link" href="#data-retention" aria-label="Permalink for Section 5.1.3"></a></div>
<p>A data retention policy must be defined and enforced. Retention periods must be based on the defined purposes and legal obligations. These may differ for different types of log entries.</p>
<p>As a general guideline, operational logs (for debugging, support) should be retained for a short period (months), while forensic/audit logs  may be retained for longer periods (years).</p>
<p>Logs that have exceeded their defined retention period must be automatically and securely purged.</p>
</section><section id="transparency-and-subject-rights"><div class="header-wrapper"><h4 id="x5-1-4-transparency-and-subject-rights"><bdi class="secno">5.1.4 </bdi>Transparency and Subject Rights</h4><a class="self-link" href="#transparency-and-subject-rights" aria-label="Permalink for Section 5.1.4"></a></div>
<p>If logs contain personal data, they must be able to comply with data subject access requests.</p>
<p>The log's structure, purpose, and retention must be documented in the organization's Register of Processing Activities.</p>
<p>A Data Protection Impact Assessment (DPIA) must be conducted for any implementation that involves large-scale or high-risk processing of personal data.</p>
</section></section><section id="access-control"><div class="header-wrapper"><h3 id="x5-2-access-control"><bdi class="secno">5.2 </bdi>Access Control</h3><a class="self-link" href="#access-control" aria-label="Permalink for Section 5.2"></a></div>
<p>Access to log data should be restricted based on the principle of least privilege.</p>
<p>It is essential to define clear policies for authorizing access to the Authorization Decision Log or parts thereof. These decisions to provide or deny access to the log should also be included in the Authorization Decision Log.</p>
<p>Common and important usage policies include:</p>
<ul>
<li><strong>(Forensic) Audits</strong>: The log is a critical tool for auditing and forensic analysis after a security incident or data breach. It can help determine what actions were permitted at a specific time and on what basis, even if that permission was technically correct but improper in hindsight.</li>
<li><strong>Observability in Trust Frameworks</strong>: The log offers a structured method for data users to provide insight into their data usage to data providers when required, as may be required in trust frameworks. It thus offers an implementation standard for "Observability services" as defined for data spaces under the EU Data Act.</li>
<li><strong>Debugging and Support</strong>: The log can be a useful tool for determining why the authorization is not working as expected. It can also contain highly sensitive data, however, so it's essential to carefully define if, and under which conditions, the Authorization Decision Log can be used for this purpose.</li>
</ul>
</section><section id="security-and-integrity"><div class="header-wrapper"><h3 id="x5-3-security-and-integrity"><bdi class="secno">5.3 </bdi>Security and Integrity</h3><a class="self-link" href="#security-and-integrity" aria-label="Permalink for Section 5.3"></a></div>
<p>The log must be protected against unauthorized access, modification, and deletion.</p>
<p>Key concerns for ensuring security and integrity include:</p>
<ul>
<li><strong>Transport Security</strong>: It's recommended to use mTLS (Mutual Transport Layer Security) for network connections that transport log data to ensure authenticated and encrypted transport.</li>
<li><strong>Encryption at Rest</strong>: All log data should be encrypted at rest. It's recommended to manage this using a Key Management System (KMS).</li>
<li><strong>Data Integrity</strong>: The log should be configured as append-only storage (WORM) to prevent undetected modification or deletion. Mechanisms such as a cryptographic hash chains and periodic cryptographic sealing can be used to ensure integrity and non-repudiation of logs.</li>
<li><strong>Time Synchronization</strong>: All systems involved in generating and storing logs should be synchronized to a trusted Network Time Protocol (NTP) source to ensure a reliable and accurate timeline of events.</li>
<li><strong>Ingestion</strong>: The logging endpoint should be implemented as idempotent writes to an asynchronous, buffered service (e.g., using a durable queue) to mitigate latency and availability risks in the event of log-ingest failures.</li>
</ul>
</section></section>
  <script>
    let content = "";

    const getClass = function(key) {
      if (respecConfig.content[key]!==""){return ` class="${respecConfig.content[key]}"`}
    }

    for (let contentKey in respecConfig.content) {
      content += `<section data-include-format="markdown" data-include="${contentKey}.md" ${getClass(contentKey)||""}></section>`
    }

    document.getElementById("sotd").insertAdjacentHTML('afterend', content);
  </script>
  <section id="conformance"><div class="header-wrapper"><h2 id="x6-conformance"><bdi class="secno">6. </bdi>Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for Section 6."></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, <em class="rfc2119">RECOMMENDED</em>, and <em class="rfc2119">SHOULD</em> in this document
        are to be interpreted as described in
        <a href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all
        capitals, as shown here.
      </p></section>
  <section id="tof"><div class="header-wrapper"><h2 id="x7-list-of-figures"><bdi class="secno">7. </bdi>List of Figures</h2><a class="self-link" href="#tof" aria-label="Permalink for Section 7."></a></div><ul class="tof">
        <li class="tofline">
    <a class="tocxref" href="#fig-eam-or-pxp-architecture"><span class="self-link">Figure <bdi class="figno">1</bdi></span> <span class="fig-title">EAM or PxP Architecture</span></a>
  </li><li class="tofline">
    <a class="tocxref" href="#fig-decision-logging-in-federated-context"><span class="self-link">Figure <bdi class="figno">2</bdi></span> <span class="fig-title">Decision logging in federated context</span></a>
  </li><li class="tofline">
    <a class="tocxref" href="#fig-writing-a-log-record-after-an-authorization-decision"><span class="self-link">Figure <bdi class="figno">3</bdi></span> <span class="fig-title">Writing a log record after an authorization decision</span></a>
  </li>
      </ul></section>
  <section id="index" class="appendix"><div class="header-wrapper"><h2 id="a-index"><bdi class="secno">A. </bdi>Index</h2><a class="self-link" href="#index" aria-label="Permalink for Appendix A."></a></div><section id="index-defined-here">
    <div class="header-wrapper"><h3 id="a-1-terms-defined-by-this-specification"><bdi class="secno">A.1 </bdi>Terms defined by this specification</h3><a class="self-link" href="#index-defined-here" aria-label="Permalink for Appendix A.1"></a></div>
    <ul class="index">
    
  </ul>
  </section><section id="index-defined-elsewhere">
    <div class="header-wrapper"><h3 id="a-2-terms-defined-by-reference"><bdi class="secno">A.2 </bdi>Terms defined by reference</h3><a class="self-link" href="#index-defined-elsewhere" aria-label="Permalink for Appendix A.2"></a></div>
    <ul class="index">
    
  </ul>
  </section></section>



<section id="references" class="appendix"><div class="header-wrapper"><h2 id="b-references"><bdi class="secno">B. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix B."></a></div><section id="normative-references">
    <div class="header-wrapper"><h3 id="b-1-normative-references"><bdi class="secno">B.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix B.1"></a></div>
    <dl class="bibliography"><dt id="bib-authzen">[AuthZen]</dt><dd>
      <a href="https://openid.net/specs/authorization-api-1_0-03.html"><cite>Authorization API 1.0 – draft 03</cite></a>. O. Gazitt; D. Brossard; A. Tulshibagwale. URL: <a href="https://openid.net/specs/authorization-api-1_0-03.html">https://openid.net/specs/authorization-api-1_0-03.html</a>
    </dd><dt id="bib-fsc - core">[FSC - Core]</dt><dd>
      <a href="https://commonground.gitlab.io/standards/fsc/core/draft-fsc-core-00.html"><cite>FSC - Core</cite></a>. Eelco Hotting; Ronald Koster; Henk van Maanen; Niels Dequeker; Edward van Gelderen; Pim Gaemers. 8 december 2023. URL: <a href="https://commonground.gitlab.io/standards/fsc/core/draft-fsc-core-00.html">https://commonground.gitlab.io/standards/fsc/core/draft-fsc-core-00.html</a>
    </dd><dt id="bib-fsc - logging">[FSC - Logging]</dt><dd>
      <a href="https://commonground.gitlab.io/standards/fsc/logging/draft-fsc-logging-00.html"><cite>FSC - Logging</cite></a>. Eelco Hotting; Ronald Koster; Henk van Maanen; Niels Dequeker; Edward van Gelderen; Pim Gaemers. 8 december 2023. URL: <a href="https://commonground.gitlab.io/standards/fsc/logging/draft-fsc-logging-00.html">https://commonground.gitlab.io/standards/fsc/logging/draft-fsc-logging-00.html</a>
    </dd><dt id="bib-logboek dataverwerkingen">[Logboek dataverwerkingen]</dt><dd>
      <a href="https://logius-standaarden.github.io/logboek-dataverwerkingen/"><cite>Logboek dataverwerkingen</cite></a>. Eelco Hotting; Vedran Bilanovic. n.t.b.. URL: <a href="https://logius-standaarden.github.io/logboek-dataverwerkingen/">https://logius-standaarden.github.io/logboek-dataverwerkingen/</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc3339">[RFC3339]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3339"><cite>Date and Time on the Internet: Timestamps</cite></a>. G. Klyne; C. Newman.  IETF. July 2002. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3339">https://www.rfc-editor.org/rfc/rfc3339</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-trace-context">[trace-context]</dt><dd>
      <a href="https://www.w3.org/TR/trace-context-1/"><cite>Trace Context</cite></a>. Sergey Kanzhelev; Morgan McLean; Alois Reitbauer; Bogdan Drutu; Nik Molnar; Yuri Shkuro.  W3C. 23 November 2021. W3C Recommendation. URL: <a href="https://www.w3.org/TR/trace-context-1/">https://www.w3.org/TR/trace-context-1/</a>
    </dd><dt id="bib-warc">[WARC]</dt><dd>
      <a href="https://www.iso.org/standard/68004.html"><cite>Information and documentation — WARC file format</cite></a>.  International Organization for Standardization (ISO). August 2017. Published. URL: <a href="https://www.iso.org/standard/68004.html">https://www.iso.org/standard/68004.html</a>
    </dd></dl>
  </section><section id="informative-references">
    <div class="header-wrapper"><h3 id="b-2-informative-references"><bdi class="secno">B.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix B.2"></a></div>
    <dl class="bibliography"><dt id="bib-bio2">[BIO2]</dt><dd>
      <a href="https://www.bio-overheid.nl/media/cs5ctudu/20250924-baseline-informatiebeveiliging-overheid-2-bio2-v12-def.pdf?csf=1&amp;web=1&amp;e=9JoWOT"><cite>Baseline Informatiebeveiliging Overheid 2</cite></a>. 24 september 2025. URL: <a href="https://www.bio-overheid.nl/media/cs5ctudu/20250924-baseline-informatiebeveiliging-overheid-2-bio2-v12-def.pdf?csf=1&amp;web=1&amp;e=9JoWOT">https://www.bio-overheid.nl/media/cs5ctudu/20250924-baseline-informatiebeveiliging-overheid-2-bio2-v12-def.pdf?csf=1&amp;web=1&amp;e=9JoWOT</a>
    </dd><dt id="bib-iso/iec 27001:2022">[ISO/IEC 27001:2022]</dt><dd>
      <a href="https://www.iso.org/standard/27001.html"><cite>Information security, cybersecurity and privacy protection — Information security management systems — Requirements</cite></a>. 2022-10. URL: <a href="https://www.iso.org/standard/27001.html">https://www.iso.org/standard/27001.html</a>
    </dd><dt id="bib-iso/iec 27002:2022">[ISO/IEC 27002:2022]</dt><dd>
      <a href="https://www.iso.org/standard/75652.html"><cite>Information security, cybersecurity and privacy protection — Information security controls</cite></a>. 2022-02. URL: <a href="https://www.iso.org/standard/75652.html">https://www.iso.org/standard/75652.html</a>
    </dd><dt id="bib-nist.sp.800-162">[NIST.SP.800-162]</dt><dd>
      <a href="https://www.nist.gov/publications/guide-attribute-based-access-control-abac-definition-and-considerations-1"><cite>Guide to Attribute Based Access Control (ABAC) Definition and Considerations</cite></a>. Chung Tong Hu; David F. Ferraiolo; David R. Kuhn. February 25, 2019. URL: <a href="https://www.nist.gov/publications/guide-attribute-based-access-control-abac-definition-and-considerations-1">https://www.nist.gov/publications/guide-attribute-based-access-control-abac-definition-and-considerations-1</a>
    </dd><dt id="bib-rest api design rules">[REST API Design Rules]</dt><dd>
      <a href="https://gitdocumentatie.logius.nl/publicatie/api/adr/"><cite>NLGov REST API Design Rules 2.0.0</cite></a>. Jasper Roes; Joost Farla. Maart 2024. URL: <a href="https://gitdocumentatie.logius.nl/publicatie/api/adr/">https://gitdocumentatie.logius.nl/publicatie/api/adr/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><div class="sidelabel">Logius Standard - Draft</div><script src="https://gitdocumentatie.logius.nl/publicatie/respec/fixup.js"></script></body></html>